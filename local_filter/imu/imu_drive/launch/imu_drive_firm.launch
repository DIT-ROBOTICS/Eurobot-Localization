<launch>

	<arg name="robot_name" default=""/>
	<arg name="robot_name_slash" default=""/>

	<arg name="param" default="1"/>

    <!-- Open imu firmware -->
   
    <include file="$(find imu_drive)/launch/spatial.launch">
        <arg name="robot_name" default="$(arg robot_name)"/>
	    <arg name="robot_name_slash" default="$(arg robot_name_slash)/"/>
    </include>

    <node pkg="imu_drive" type="imu_drive_node" name="imu_node">

        <rosparam command="load" file="$(find imu_drive)/param/imu_drive_firm.yaml" if="$(eval arg('param')==1)"/>

        <param name="sub_topic" value="/$(arg robot_name)/imu/data_corrected"/>
        <param name="pub_topic" value="/$(arg robot_name)/imu/data_cov"/>
        <remap from="/cmd_vel" to="/$(arg robot_name)/cmd_vel"/>
        <remap from="/ekf_pose" to="/$(arg robot_name)/ekf_pose_in_pose"/>

        <param name="frame" value="$(arg robot_name_slash)imu_link"/>

    </node>

    <node pkg="imu_calib" type="apply_calib" name="apply_calib" output="screen">
        <remap from="corrected" to="/$(arg robot_name)/imu/data_corrected"/>
        <remap from="raw" to="/$(arg robot_name)/imu/data"/>
        <param name="calib_file" value="/home/leokang/Eurobot2023_localization_ws/src/localization/local_filter/imu/imu_calib/imu_calib_4.yaml"/>

    </node>

</launch>